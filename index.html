<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>VALKNUTPOWER - Elite Training System</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0a0a0c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="VALKNUT">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2936/2936886.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&display=swap');

        /* DISEÑO DE EMERGENCIA (Si falla el internet en el gym) */
        :root {
            --brand-red: #D94343;
            --brand-dark: #0a0a0c;
            --cyan: #00f2ff;
            --gold: #FFD700;
        }

        body {
            font-family: 'Outfit', -apple-system, sans-serif;
            background-color: var(--brand-dark);
            color: white;
            margin: 0;
            padding-bottom: 80px;
        }

        /* Estilos base para cuando Tailwind NO carga */
        .glass-card {
            background: #1a1a1c;
            border: 2px solid #333;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 15px;
        }

        .exercise-title {
            font-size: 28px !important;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            margin: 0 0 10px 0;
            line-height: 1;
        }

        .reps-badge {
            background-color: var(--brand-red);
            font-size: 20px;
            font-weight: 900;
            padding: 5px 15px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .notes-text {
            font-size: 16px;
            color: #aaa;
            font-style: italic;
            background: #000;
            padding: 10px;
            border-radius: 10px;
            display: block;
        }

        nav {
            background: black;
            padding: 15px;
            border-bottom: 2px solid #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .offline-ready-tag {
            background: green;
            color: white;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            margin-top: 5px;
        }

        /* Ocultar elementos si Tailwind carga (se sobreescribirá) */
        .hidden-offline {
            display: none;
        }
    </style>
</head>

<body class="antialiased pb-20">

    <!-- Header / Nav -->
    <nav class="sticky top-0 z-50 bg-black/80 backdrop-blur-lg border-b border-white/10 py-4 px-6 md:px-12">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <h1 class="text-4xl font-black italic tracking-tighter">VALKNUT<span class="text-red-500">POWER</span></h1>

            <div class="flex items-center gap-3">
                <div class="flex bg-white/5 p-1 rounded-2xl border border-white/10" id="gender-selector">
                    <button onclick="setGender('man')" id="btn-man"
                        class="nav-btn px-8 py-3 rounded-xl text-sm font-black transition active">ÉL</button>
                    <button onclick="setGender('woman')" id="btn-woman"
                        class="nav-btn px-8 py-3 rounded-xl text-sm font-black transition">ELLA</button>
                </div>

                <div class="flex bg-white/5 p-1 rounded-2xl border border-white/10">
                    <button onclick="setMode('hybrid')" id="btn-hybrid"
                        class="mode-btn px-4 py-2 rounded-xl text-xs font-black uppercase transition active">Hybrid</button>
                    <button onclick="setMode('valknut')" id="btn-valknut"
                        class="mode-btn px-4 py-2 rounded-xl text-xs font-black uppercase transition">PRO</button>
                </div>

                <button onclick="togglePartnerMode()" id="partner-toggle"
                    class="bg-cyan-500/10 text-cyan-400 border border-cyan-500/50 px-4 py-2 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-cyan-500 hover:text-black transition-all">
                    SYNC: <span id="partner-status">OFF</span>
                </button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-8">

        <!-- Banner & Selector -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-6">
            <div id="routine-title-box"
                class="flex items-center gap-3 bg-red-600/10 border border-red-600/30 px-6 py-3 rounded-2xl">
                <span id="current-routine-label"
                    class="text-xs font-black text-red-500 uppercase tracking-widest italic">Protocolo Híbrido
                    Partner</span>
            </div>

            <div class="flex gap-2 bg-white/5 p-2 rounded-full border border-white/10 overflow-x-auto max-w-full"
                id="day-selector">
                <button onclick="setDay(0)"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition active">LUN</button>
                <button onclick="setDay(1)"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition">MAR</button>
                <button onclick="setDay(2)"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition">MIE</button>
                <button onclick="setDay(3)"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition">JUE</button>
                <button onclick="setDay(4)"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition">VIE</button>
                <button onclick="setDay(5)" id="btn-sat"
                    class="day-btn w-12 h-12 rounded-full font-black text-xs transition hidden">SAB</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Training -->
            <div id="training-container" class="lg:col-span-2 space-y-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-3xl font-black italic uppercase"><span id="display-day">LUNES</span>: <span
                            class="text-red-500" id="display-focus">TREN SUPERIOR</span></h2>
                </div>

                <div id="exercise-list" class="space-y-4">
                    <!-- Dynamic -->
                </div>
            </div>

            <!-- Sidebars -->
            <div class="space-y-6">
                <!-- Diet -->
                <div class="glass-card p-8">
                    <h3
                        class="text-xl font-black mb-6 italic text-cyan-400 uppercase tracking-tighter border-b border-white/10 pb-4">
                        <i class="fas fa-apple-alt mr-2"></i> Nutrición Estratégica
                    </h3>
                    <div id="diet-info" class="space-y-6"></div>

                    <div class="mt-8 p-4 bg-white/5 rounded-2xl border border-white/10">
                        <h4 class="text-[10px] font-black text-gray-400 uppercase mb-3 text-center">Calculadora Valknut
                        </h4>
                        <div class="flex items-end justify-center gap-2 mb-2">
                            <span id="cal-count" class="text-4xl font-black text-white">---</span>
                            <span class="text-xs font-bold text-gray-500 mb-2">kcal</span>
                        </div>
                        <input type="number" id="user-weight" placeholder="Peso (kg)" oninput="updateCals()"
                            class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2 text-sm outline-none focus:border-red-500 transition text-center">
                    </div>
                </div>

                <!-- Jeremy Ethier's Gold Rules -->
                <div class="glass-card p-6" id="gold-rules-box">
                    <h4
                        class="text-xs font-black uppercase text-gold-500 mb-4 tracking-widest text-center text-[#FFD700]">
                        Jeremy Ethier's Gold Rules</h4>
                    <div class="space-y-3">
                        <div class="p-3 bg-white/5 rounded-xl text-[10px] border-l-2 border-yellow-500">
                            <strong>Doble Progresión:</strong> Sube el peso solo cuando alcances el máximo de reps en
                            todas las series.
                        </div>
                        <div class="p-3 bg-white/5 rounded-xl text-[10px] border-l-2 border-yellow-500">
                            <strong>Descanso Elite:</strong> 3 min para compuestos (pesados), 1-2 min para aislamiento.
                        </div>
                    </div>
                </div>

                <!-- Glossary -->
                <div class="glass-card p-6">
                    <h4 class="text-xs font-black uppercase text-gray-500 mb-4 tracking-widest text-center">Intensidad
                        Pro</h4>
                    <div class="space-y-3">
                        <div class="p-3 bg-white/5 rounded-xl text-[10px]">
                            <strong class="text-red-500 block">RIR (Reps in Reserve)</strong>
                            Cuán cerca del fallo te quedas. RIR 1 = casi al fallo.
                        </div>
                        <div class="p-3 bg-white/5 rounded-xl text-[10px]">
                            <strong class="text-purple-500 block">PARCIALES</strong>
                            Al llegar al fallo, haz medias repeticiones en estiramiento.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let state = {
            gender: 'man',
            day: 0,
            partnerMode: false,
            mode: 'hybrid' // 'hybrid' or 'valknut'
        };

        const workoutData = {
            man: [
                {
                    focus: "TREN SUPERIOR (FUERZA)", exercises: [
                        { name: "Press de Banca Plano", reps: "4x6-8", tech: "Carga Progresiva", notes: "Controla el descenso 3 seg." },
                        { name: "Remo con Barra", reps: "4x8-10", tech: "Retracción Escapular", notes: "Espalda paralela al suelo." },
                        { name: "Press Inclinado Mancuernas", reps: "3x10-12", tech: "Tempo 3-1-1", notes: "Foco pecho superior." },
                        { name: "Jalón al Pecho (Ancho)", reps: "3x12", tech: "Conexión Dorsal", notes: "Lleva codos a la cadera." },
                        { name: "Press Militar Barra", reps: "3x8-10", tech: "RIR 2", notes: "Core ultra estable." },
                        { name: "Elevaciones Laterales", reps: "4x15-20", tech: "Drop Set Final", notes: "Hombros hacia atrás." },
                        { name: "Curl Bíceps Barra Z", reps: "3x12", tech: "Sin Inercia", notes: "Codos bloqueados al torso." }
                    ], diet: { title: "Día de Carga (HI)", desc: "2.5g Carbos x kg. Prioriza hidratos antes de entrenar.", menu: "Pasta Boloñesa (Carne magra), Avena con Proteína." }
                },
                {
                    focus: "TREN INFERIOR (POTENCIA)", exercises: [
                        { name: "Sentadilla Libre Barra", reps: "4x6-8", tech: "Explosividad", notes: "Baja controlado, sube rápido." },
                        { name: "Prensa de Piernas (45°)", reps: "3x12-15", tech: "Pausa en Máximo Estiramiento", notes: "No bloquees rodillas arriba." },
                        { name: "Zancadas Caminando", reps: "3x20 pasos", tech: "Control Tensión", notes: "Zancada larga." },
                        { name: "Extensión de Cuádriceps", reps: "4x15", tech: "5 Parciales al final", notes: "Quema máxima." },
                        { name: "Curl Femoral Tumbado", reps: "3x12", tech: "Negativa 4 seg", notes: "Baja muy lento." },
                        { name: "Elevación Talones", reps: "4x20", tech: "Stretch Focus", notes: "Siente el estiramiento abajo." }
                    ], diet: { title: "Fuerza y Volumen", desc: "Suplementación Vit. D y Creatina. Hidratación 4L.", menu: "Arroz jazmín, Filete a la plancha, Boniato." }
                },
                {
                    focus: "EMPUJE / PUSH (UPPER)", exercises: [
                        { name: "Press Smith Inclinado", reps: "3x8-10", tech: "Protocolo 10/25", notes: "Máxima tensión pectoral." },
                        { name: "Aperturas Mancuernas", reps: "3x15", tech: "Estiramiento Profundo", notes: "No flexiones codos de más." },
                        { name: "Press Hombro Sentado", reps: "3x10-12", tech: "RIR 1", notes: "Mancuernas pesadas." },
                        { name: "Elevaciones Laterales Polea", reps: "4x12", tech: "Tensión Constante", notes: "Cruza polea por delante." },
                        { name: "Press de Banca Cerrado", reps: "3x10", tech: "Foco Tríceps", notes: "Manos a ancho de hombros." },
                        { name: "Press Francés", reps: "3x12", tech: "Máxima Extensión", notes: "Barra a la frente." }
                    ], diet: { title: "Crecimiento Muscular", desc: "Proteína alta (2.2g/kg). Superávit ligero.", menu: "Huevos revueltos, Pollo mechado, Arroz blanco." }
                },
                {
                    focus: "PIERNA TOTAL (LOWER)", exercises: [
                        { name: "Hip Thrust Pesado", reps: "4x10", tech: "Método Colina", notes: "Mentón al pecho. Pausa 2s arriba." },
                        { name: "Peso Muerto Rumano", reps: "4x10", tech: "Stretch Isquios", notes: "Siente el estiramiento intenso." },
                        { name: "Sentadilla Búlgara", reps: "3x12 por pierna", tech: "Tensión Glúteo", notes: "Torso inclinado adelante." },
                        { name: "Curl Femoral Sentado", reps: "4x15", tech: "Rest-Pause", notes: "Efectivo para desarrollo isquio." },
                        { name: "Abducciones en Polea", reps: "3x20", tech: "Tensión Lateral", notes: "Glúteo medio a tope." }
                    ], diet: { title: "Máxima Recarga", desc: "Día de comida trampa si es necesario. Carga glucógeno.", menu: "Hamburguesa magra, Patatas al horno, Yogur Griego." }
                },
                {
                    focus: "ESPALDA GROSOR (DÍA 5 PDF)", exercises: [
                        { name: "Peso Muerto + Hiperextensión", reps: "2x20 (Biserie)", tech: "Activación Lumbar", notes: "Serie gigante para calentar la espalda baja." },
                        { name: "Hammer Espalda", reps: "4x6-15", tech: "Técnica 10/25", notes: "2 sets pesados + 2 sets con técnica élite." },
                        { name: "Remo Polea + Pull Over", reps: "3x8-10 (Biserie)", tech: "Rest Pause", notes: "En el remo haz pausa. Pull over 12-20 reps." },
                        { name: "Jalón Polea", reps: "3x8-12", tech: "Técnica 10/25", notes: "Codos hacia abajo. 2 sets con técnica 10/25." },
                        { name: "Máquina Espalda (Apoyada)", reps: "2x6-10", tech: "2 Dropsets", notes: "Pecho pegado al apoyo. Máximo estiramiento." },
                        { name: "Cruce Poleas Alta (Delt)", reps: "6x15", tech: "Biserie Posterior", notes: "Sincroniza con hombros posterior con lazo (x20)." }
                    ], diet: { title: "Recuperación Activa", desc: "Antioxidantes naturales. Foco en micronutrientes.", menu: "Salmón, Brócoli al vapor, Frutos del bosque." }
                }
            ],
            woman: [
                {
                    focus: "TREN SUPERIOR (SYNC)", exercises: [
                        { name: "Jalón al Pecho Abierto", reps: "3x12", tech: "Retracción Escapular", notes: "Lleva la barra al pecho, no al ombligo." },
                        { name: "Remo en Polea Baja", reps: "3x12", tech: "Codos a la Cadera", notes: "Aprieta la espalda media 1 seg." },
                        { name: "Press Militar Mancuernas", reps: "3x12", tech: "Empuje Vertical", notes: "No bloquees codos arriba." },
                        { name: "Elevaciones Laterales", reps: "3x12", tech: "Vuelo Controlado", notes: "Sube hasta la altura de los hombros." },
                        { name: "Curl Bíceps Mancuernas", reps: "3x12", tech: "Supinación", notes: "Gira la palma hacia arriba." },
                        { name: "Extensión Tríceps Polea", reps: "3x12", tech: "Codos Bloqueados", notes: "Solo se mueven tus antebrazos." }
                    ], diet: { title: "Día de Tono", desc: "Proteína alta para reparar fibras.", menu: "Omelette con espinaca, Pollo y Brócoli." }
                },
                {
                    focus: "TREN INFERIOR (SYNC)", exercises: [
                        { name: "Extensión de Cuádriceps", reps: "3x12", tech: "Pausa Pico", notes: "Aguanta 1 segundo arriba." },
                        { name: "Cuádriceps en Prensa", reps: "3x12", tech: "Pies Bajos", notes: "Foco en la parte delantera de la pierna." },
                        { name: "Sentadilla Búlgara", reps: "3x12", tech: "Focus Glúteo", notes: "Mantén el torso un poco inclinado." },
                        { name: "Peso Muerto Rumano", reps: "3x12", tech: "Stretch Focus", notes: "Baja la barra pegada a tus piernas." },
                        { name: "Curl Femoral Tumbado", reps: "3x12", tech: "Control Excétrico", notes: "Baja muy lento las piernas." },
                        { name: "Pantorrilla en Máquina", reps: "3x12", tech: "Rango Máximo", notes: "Baja bien los talones." }
                    ], diet: { title: "Día de Fuerza", desc: "Prioriza hidratos complejos post-gym.", menu: "Bowl de Avena, Salmón con Quinoa." }
                },
                {
                    focus: "JALÓN / UPPER (ALTERNO)", exercises: [
                        { name: "Jalón al Pecho", reps: "3x12", tech: "Control Tensión", notes: "Controla la subida de la barra." },
                        { name: "Remo Polea Baja", reps: "3x12", tech: "Retracción", notes: "Saca pecho al tirar de la polea." },
                        { name: "Press Militar", reps: "3x12", tech: "Mancuernas", notes: "Hombros estéticos y fuertes." },
                        { name: "Elevaciones Laterales", reps: "3x12", tech: "Pinky Up", notes: "Siente el trabajo en el lateral." },
                        { name: "Curl Bíceps", reps: "3x12", tech: "Aislamiento", notes: "No balancees el cuerpo." },
                        { name: "Cardio (Cinta)", reps: "35 min", tech: "LISS", notes: "Caminata rápida constante." }
                    ], diet: { title: "Definición", desc: "Control de insulina.", menu: "Ensalada Completa, Atún y Aguacate." }
                },
                {
                    focus: "GLÚTEO / EMPUJE (ALTERNO)", exercises: [
                        { name: "Elevación de Caderas (HT)", reps: "3x12", tech: "Método Colina", notes: "Aprieta glúteos fuerte arriba." },
                        { name: "Sentadilla Sumo", reps: "3x12", tech: "Sumo Stance", notes: "Pies bien abiertos hacia afuera." },
                        { name: "Patada Glúteo Polea", reps: "3x12", tech: "Peak Contraction", notes: "Patea hacia atrás y arriba." },
                        { name: "Hiperextensiones", reps: "3x15", tech: "Barbilla al Pecho", notes: "Curva un poco la espalda para glúteo." },
                        { name: "Abducción con Banda", reps: "3x25", tech: "Pump Lateral", notes: "Camina de lado con la banda." }
                    ], diet: { title: "Día de Glúteo", desc: "Carga de hidratos estratégica.", menu: "Pasta integral, Smoothie de Proteína." }
                },
                {
                    focus: "JALÓN / ESPALDA (SYNC PDF)", exercises: [
                        { name: "Jalón al Pecho", reps: "3x12", tech: "Tensión Constante", notes: "Coincide con su Jalón del PDF." },
                        { name: "Remo Polea Baja", reps: "3x12", tech: "Retracción Escapular", notes: "Coincide con su Biserie del PDF." },
                        { name: "Pull Over con Cuerda", reps: "3x15", tech: "Dorsal Focus", notes: "Brazos rectos. Siente el estiramiento." },
                        { name: "Face Pulls", reps: "3x15", tech: "Postura", notes: "Lleva la cuerda hacia tu frente." },
                        { name: "Pájaros con Mancuerna", reps: "3x15", tech: "Hombro Posterior", notes: "Coincide con su Biserie de Deltóides." },
                        { name: "Plancha Abdominal", reps: "3x1 min", tech: "Core Bracing", notes: "Finalizador de core sincronizado." }
                    ], diet: { title: "Día de Carga Final", desc: "Recarga glucógeno completa.", menu: "Sushi o Hamburguesa magra, Frutas." }
                }
            ],
            valknut: [
                {
                    focus: "SUPERIOR (FUERZA & COMPUESTOS)", exercises: [
                        { name: "Press de Banca con Barra", reps: "3x6-8", tech: "Compuesto Elite", notes: "Ejercicio clave Jeremy. Activa deltoides frontales." },
                        { name: "Remo con Barra (Bent Over Row)", reps: "3x8-10", tech: "Compuesto Elite", notes: "Fundamental para el grosor de espalda." },
                        { name: "Press Militar", reps: "3x8-12", tech: "Rango Completo", notes: "Hombros potentes de pie o sentado." },
                        { name: "Dominadas (Pull-ups)", reps: "3 al Fallo", tech: "Rey Dorsales", notes: "Usa banda si es necesario. Controla el descenso." },
                        { name: "Elevaciones Laterales", reps: "3x12-15", tech: "Ancho Hombros", notes: "Inclínate levemente al lado trabajado." }
                    ], diet: { title: "Fuerza Jeremy", desc: "Superávit ligero. Proteína 2.2g/kg.", menu: "Avena con fruta, Carne roja y Arroz." }
                },
                {
                    focus: "INFERIOR (CUÁDRICEPS)", exercises: [
                        { name: "Sentadilla con Barra", reps: "3x6-8", tech: "Tempo 3-0-1", notes: "Bajar muy lento, explotar hacia arriba." },
                        { name: "Prensa de Piernas", reps: "3x10-12", tech: "Heavy Weight", notes: "No cargues la espalda baja, empuja pesado." },
                        { name: "Bulgarian Split Squat", reps: "3x8-10", tech: "Equilibrio Pro", notes: "Torso recto para máximo enfoque en cuads." },
                        { name: "Extensiones de Cuádriceps", reps: "3x15", tech: "Recto Femoral", notes: "Pausa 1s en contracción máxima." },
                        { name: "Elevación Talones", reps: "4x15", tech: "Pausa en Extremos", notes: "Pausa arriba y abajo. Pierna recta." }
                    ], diet: { title: "Carga Inferior", desc: "Alta carga de glucógeno.", menu: "Pasta integral, Pollo, Boniato." }
                },
                {
                    focus: "DESCANSO ACTIVO / ABS", exercises: [
                        { name: "Reverse Crunch", reps: "3x15-20", tech: "Lower Abs", notes: "Enfoque en abdominales inferiores." },
                        { name: "Plancha Abdominal", reps: "4x1 min", tech: "Core Bracing", notes: "Mantén tensión en todo el cuerpo." },
                        { name: "Cardio Ligero", reps: "30 min", tech: "LISS", notes: "Caminata o bici suave para recuperar." }
                    ], diet: { title: "Recuperación Elite", desc: "Día de mantenimiento calórico.", menu: "Ensalada completa, Pescado blanco." }
                },
                {
                    focus: "EMPUJE (UPPER)", exercises: [
                        { name: "Press Inclinado Mancuernas", reps: "3x8-12", tech: "Asimetrías", notes: "Mejor para el pecho superior." },
                        { name: "Aperturas (Cable Flys)", reps: "3x12-15", tech: "Stretch focus", notes: "Haz parciales al final en estiramiento." },
                        { name: "Elevaciones Laterales (Cable)", reps: "4x15-20", tech: "Tensión Constante", notes: "Cruza cables para mejor ángulo." },
                        { name: "Fondos (Dips)", reps: "3 al Fallo", tech: "Pecho Inferior", notes: "Inclínate adelante para enfocar pecho." },
                        { name: "Extensión Tríceps sobre Cabeza", reps: "3x12-15", tech: "Long Head", notes: "Estira bien el tríceps atrás." }
                    ], diet: { title: "Hipertrofia Push", desc: "Moderado en carbos. Foco hidratación.", menu: "Huevos, Pollo picado, Arroz jazmín." }
                },
                {
                    focus: "PIERNAS (LOWER)", exercises: [
                        { name: "Peso Muerto Rumano", reps: "3x8-10", tech: "Bisagra Cadera", notes: "El mejor para isquios. Baja lento." },
                        { name: "Hip Thrust", reps: "3x10-12", tech: "Rey Glúteos", notes: "Pausa 2 segundos arriba. Aprieta." },
                        { name: "Zancadas Caminando", reps: "3x12", tech: "Pasos Largos", notes: "Pasos amplios para glúteo." },
                        { name: "Curl Femoral Sentado", reps: "3x12-15", tech: "Superior Stretch", notes: "Superior al tumbado por angulación." }
                    ], diet: { title: "Carga Isquios", desc: "Día de comida libre moderada.", menu: "Hamburguesa magra, Bowl de Arroz." }
                },
                {
                    focus: "JALÓN (UPPER FINAL)", exercises: [
                        { name: "Jalón al Pecho", reps: "3x10-12", tech: "Codos Abajo", notes: "Enfócate en tirar con los codos." },
                        { name: "Remo en Polea", reps: "3x10-12", tech: "Stretch Dorsal", notes: "Permite un gran estiramiento atrás." },
                        { name: "Face Pulls", reps: "4x15", tech: "Salud Hombro", notes: "Clave para deltoides posterior." },
                        { name: "Curl de Bíceps Inclinado", reps: "3x8-12", tech: "Max Stretch", notes: "Brazos por detrás del cuerpo." },
                        { name: "Curl Martillo", reps: "3x10-12", tech: "Braquial", notes: "Da grosor lateral al brazo." }
                    ], diet: { title: "Hipertrofia Pull", desc: "Micronutrientes altos.", menu: "Salmón con brócoli, Nueces." }
                }
            ]
        };

        const dayNames = ["LUNES", "MARTES", "MIÉRCOLES", "JUEVES", "VIERNES", "SÁBADO"];

        function updateCals() {
            const w = document.getElementById('user-weight').value;
            if (!w) return;
            const factor = state.mode === 'valknut' ? 16 : (state.day % 2 === 0 ? 15.5 : 14);
            const res = w * 2.2 * factor;
            document.getElementById('cal-count').innerText = Math.round(res);
        }

        function setGender(g) {
            state.gender = g;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${g}`).classList.add('active');
            render();
        }

        function setMode(m) {
            state.mode = m;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${m}`).classList.add('active');

            const routineLabel = document.getElementById('current-routine-label');
            const satBtn = document.getElementById('btn-sat');
            const genSelector = document.getElementById('gender-selector');
            const partnerToggle = document.getElementById('partner-toggle');
            const trainingBox = document.getElementById('routine-title-box');

            if (m === 'valknut') {
                state.partnerMode = false;
                routineLabel.innerText = "Valknut Pro Edition (Jeremy Ethier Split)";
                satBtn.classList.remove('hidden');
                genSelector.classList.add('hidden');
                partnerToggle.classList.add('hidden');
                trainingBox.classList.add('animate-pro');
                if (state.day > 5) state.day = 0;
            } else {
                routineLabel.innerText = "Protocolo Híbrido Partner";
                satBtn.classList.add('hidden');
                genSelector.classList.remove('hidden');
                partnerToggle.classList.remove('hidden');
                trainingBox.classList.remove('animate-pro');
                if (state.day > 4) setDay(0);
            }
            render();
        }

        function setDay(d) {
            state.day = d;
            document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.day-btn')[d].classList.add('active');
            updateCals();
            render();
        }

        function togglePartnerMode() {
            state.partnerMode = !state.partnerMode;
            const btn = document.getElementById('partner-toggle');
            document.getElementById('partner-status').innerText = state.partnerMode ? 'ON' : 'OFF';
            if (state.partnerMode) {
                btn.classList.add('bg-cyan-500', 'text-black');
            } else {
                btn.classList.remove('bg-cyan-500', 'text-black');
            }
            render();
        }

        function render() {
            const list = document.getElementById('exercise-list');
            const dietCont = document.getElementById('diet-info');
            const displayFocus = document.getElementById('display-focus');

            document.getElementById('display-day').innerText = dayNames[state.day];

            if (state.mode === 'valknut') {
                const data = workoutData.valknut[state.day];
                displayFocus.innerText = data.focus;
                list.innerHTML = data.exercises.map(ex => `
                    <div class="glass-card p-8 flex justify-between items-center group hover:bg-white/5 transition border-l-8 border-l-yellow-500 shadow-xl">
                        <div class="flex-1">
                            <h4 class="exercise-title text-2xl font-black text-white mb-2 uppercase tracking-tighter leading-none">${ex.name}</h4>
                            <div class="flex items-center gap-3 mb-3">
                                <span class="reps-badge bg-yellow-500 text-black text-xl font-black px-4 py-1 rounded-lg uppercase shadow-lg">${ex.reps}</span>
                                <span class="gold-tag uppercase tracking-widest text-xs font-bold">${ex.tech}</span>
                            </div>
                            <p class="notes-text text-sm text-gray-400 italic font-bold bg-white/5 p-2 rounded-lg inline-block"><i class="fas fa-info-circle text-yellow-500 mr-2"></i> ${ex.notes}</p>
                        </div>
                        <a href="https://www.youtube.com/results?search_query=jeremy+ethier+${ex.name.replace(/ /g, '+')}" target="_blank" class="w-14 h-14 bg-yellow-500 text-black rounded-full flex items-center justify-center hover:scale-110 transition shadow-[0_0_20px_rgba(255,215,0,0.3)]">
                            <i class="fas fa-play text-xl"></i>
                        </a>
                    </div>
                `).join('');

                dietCont.innerHTML = `
                    <div class="p-5 bg-gradient-to-br from-yellow-500/10 to-transparent rounded-3xl border border-yellow-500/20">
                        <h5 class="text-yellow-500 font-black text-xs uppercase mb-2 tracking-widest italic">${data.diet.title}</h5>
                        <p class="text-[11px] text-gray-400 leading-relaxed font-light">${data.diet.desc}</p>
                    </div>
                    <div class="p-4 bg-white/5 rounded-2xl border border-white/5 shadow-inner mt-4">
                        <h5 class="text-[9px] font-black text-gray-500 uppercase tracking-widest mb-3">Menú Jeremy Ethier</h5>
                        <div class="text-white text-xs font-bold border-l-2 border-yellow-500 pl-3 leading-relaxed">${data.diet.menu}</div>
                    </div>
                `;
            } else if (!state.partnerMode) {
                const data = workoutData[state.gender][state.day];
                displayFocus.innerText = data.focus;
                list.innerHTML = data.exercises.map(ex => `
                    <div class="glass-card p-8 flex justify-between items-center group hover:bg-white/5 transition border-l-8 border-l-red-600 shadow-xl">
                        <div class="flex-1">
                            <h4 class="exercise-title text-2xl font-black text-white mb-2 uppercase tracking-tighter leading-none">${ex.name}</h4>
                            <div class="flex items-center gap-3 mb-3">
                                <span class="reps-badge bg-red-600 text-white text-xl font-black px-4 py-1 rounded-lg uppercase shadow-lg">${ex.reps}</span>
                                <span class="tech-tag uppercase tracking-widest text-xs font-bold">${ex.tech}</span>
                            </div>
                            <p class="notes-text text-sm text-gray-400 italic font-bold bg-white/5 p-2 rounded-lg inline-block"><i class="fas fa-info-circle text-red-500 mr-2"></i> ${ex.notes}</p>
                        </div>
                        <a href="https://www.youtube.com/results?search_query=tecnica+${ex.name.replace(/ /g, '+')}" target="_blank" class="w-14 h-14 bg-red-600 text-white rounded-full flex items-center justify-center hover:scale-110 transition shadow-[0_0_20px_rgba(217,67,67,0.3)]">
                            <i class="fas fa-play text-xl"></i>
                        </a>
                    </div>
                `).join('');

                dietCont.innerHTML = `
                    <div class="p-5 bg-gradient-to-br from-red-500/10 to-transparent rounded-3xl border border-red-500/20">
                        <h5 class="text-red-500 font-black text-xs uppercase mb-2 tracking-widest italic">${data.diet.title}</h5>
                        <p class="text-[11px] text-gray-400 leading-relaxed font-light">${data.diet.desc}</p>
                    </div>
                    <div class="p-4 bg-white/5 rounded-2xl border border-white/5 shadow-inner mt-4">
                        <h5 class="text-[9px] font-black text-gray-500 uppercase tracking-widest mb-3">Menú Destacado</h5>
                        <div class="text-white text-xs font-bold border-l-2 border-cyan-500 pl-3 leading-relaxed">${data.diet.menu}</div>
                    </div>
                `;
            } else {
                displayFocus.innerText = "ENTRENAMIENTO SINCRONIZADO";
                const man = workoutData['man'][state.day];
                const woman = workoutData['woman'][state.day];
                let combinedHtml = `<div class="grid grid-cols-1 md:grid-cols-2 gap-4">`;
                const maxEx = Math.max(man.exercises.length, woman.exercises.length);

                for (let i = 0; i < maxEx; i++) {
                    const exM = man.exercises[i] || { name: "-", reps: "-", tech: "-" };
                    const exW = woman.exercises[i] || { name: "-", reps: "-", tech: "-" };
                    combinedHtml += `
                        <div class="glass-card p-6 border-l-8 border-l-red-500 bg-red-500/5 hover:bg-red-500/10 transition relative group">
                             <div class="flex justify-between items-start mb-2">
                                 <span class="text-xs font-black text-gray-400 uppercase tracking-widest">ÉL</span>
                                 <span class="text-lg font-black text-red-500 bg-red-500/10 px-2 rounded">${exM.reps}</span>
                             </div>
                             <h4 class="text-xl font-black text-white uppercase truncate pr-8 leading-none">${exM.name}</h4>
                             <a href="https://www.youtube.com/results?search_query=tecnica+${exM.name.replace(/ /g, '+')}" target="_blank" class="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg"><i class="fas fa-play text-xs"></i></a>
                        </div>
                        <div class="glass-card p-6 border-l-8 border-l-cyan-500 bg-cyan-500/5 hover:bg-cyan-500/10 transition relative group">
                             <div class="flex justify-between items-start mb-2">
                                 <span class="text-xs font-black text-gray-400 uppercase tracking-widest">ELLA</span>
                                 <span class="text-lg font-black text-cyan-400 bg-cyan-500/10 px-2 rounded">${exW.reps}</span>
                             </div>
                             <h4 class="text-xl font-black text-white uppercase truncate pr-8 leading-none">${exW.name}</h4>
                             <a href="https://www.youtube.com/results?search_query=tecnica+${exW.name.replace(/ /g, '+')}" target="_blank" class="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-cyan-600 text-white rounded-full flex items-center justify-center shadow-lg"><i class="fas fa-play text-xs"></i></a>
                        </div>
                    `;
                }
                combinedHtml += `</div>`;
                list.innerHTML = combinedHtml;

                dietCont.innerHTML = `
                    <div class="p-4 bg-red-500/10 rounded-2xl border border-red-500/20 mb-3">
                        <h5 class="text-red-400 font-black text-xs uppercase mb-1 italic">ÉL: ${man.diet.title}</h5>
                        <p class="text-[10px] text-gray-400 leading-relaxed">${man.diet.desc}</p>
                    </div>
                    <div class="p-4 bg-cyan-500/10 rounded-2xl border border-cyan-500/20">
                        <h5 class="text-cyan-400 font-black text-xs uppercase mb-1 italic">ELLA: ${woman.diet.title}</h5>
                        <p class="text-[10px] text-gray-400 leading-relaxed">${woman.diet.desc}</p>
                    </div>
                `;
            }
        }

        window.onload = () => {
            render();
            updateCals();

            // Register Service Worker for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker Registered'))
                    .catch(err => console.log('Service Worker Failed', err));
            }
        };
    </script>
</body>

</html>